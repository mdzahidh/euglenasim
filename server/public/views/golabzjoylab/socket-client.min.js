var socketHandle="/golabzjoylab",socketStrs={setConnection:socketHandle+"/#setConnection",updateBpus:socketHandle+"/#updateBpus",ledsSet:socketHandle+"/#ledsSet",ping:socketHandle+"/#ping",kickFromLab:socketHandle+"/#kickFromLab"};!function(){"use strict";app=app||{};var a={};a.lastPing=new Date,a.lastBpuUpdate=null,a.mySocket=null,a.options=null,a.connectionInfo=null,app.userSocketClient=a,a.setConnection=function(b,c){a.options=b;var d=!1,e=setTimeout(function(){d||(d=!0,c("timed out",null))},a.options.timeoutInterval);a.mySocket=io.connect(),a.mySocket.on("connect",function(){d||(a.connectionInfo=b.connectionInfo,a.connectionInfo.socketID=a.mySocket.id,a.connectionInfo.socketHandle=socketHandle,a.mySocket.on(socketStrs.ping,function(a){a&&"function"==typeof a&&a()}),console.log(socketStrs.setConnection),a.mySocket.emit(socketStrs.setConnection,a.connectionInfo,function(b,f){d||(d=!0,clearTimeout(e),app.mainView.roughLabStartDate=new Date,b?c(b,null):(null===f.setLedsObj||void 0===f.setLedsObj?f.setLedsObj={time:null,topValue:null,rightValue:null,bottomValue:null,leftValue:null,metaData:{username:a.connectionInfo.username,userID:a.connectionInfo.userID,expID:a.connectionInfo.liveBpuExperimentID,bpuID:a.connectionInfo.bpuID,sessionID:a.connectionInfo.sessionID}}:(f.setLedsObj.metaData.username=a.connectionInfo.username,f.setLedsObj.metaData.userID=a.connectionInfo.userID,f.setLedsObj.metaData.expID=a.connectionInfo.liveBpuExperimentID,f.setLedsObj.metaData.bpuID=a.connectionInfo.bpuID,f.setLedsObj.metaData.sessionID=a.connectionInfo.sessionID),c(null,f.setLedsObj)),a.mySocket.on(socketStrs.kickFromLab,function(a){app.mainView.kickUser()}))}))})},a.startUpdateBpus=function(){a.mySocket.on(socketStrs.updateBpus,function(b){a.lastBpuUpdate=new Date,b.bpusPackage&&b.bpusPackage.forEach&&b.bpusPackage.length>0&&b.bpusPackage.forEach(function(a){if(a.username===app.mainView.user.get("username")&&"live"===a.type){var b=a.expTimeLeft;Math.round(a.expTimeLeft/1e3);app.mainView.setTimeLeftInLabLabel(b,0,!0),app.mainView.wasTimeSetFromUpdate=!0}})})},a.ledsSet=function(b){b.sentTime=(new Date).getTime(),a.mySocket.emit(socketStrs.ledsSet,b,function(a,b){})}}();
//# sourceMappingURL=socket-client.min.js.map