!function(){"use strict";app=app||{},app.Login=Backbone.Model.extend({url:"/login/",defaults:{errors:[],errfor:{},username:"",password:"",autologin:""}}),app.LoginView=Backbone.View.extend({el:"#login",template:_.template($("#tmpl-login").html()),events:{"submit form":"preventSubmit",'keypress [name="password"]':"loginOnEnter","click .btn-login":"login"},isAttemptingAutoLogin:!1,initialize:function(){var a=unescape($("#data-autologin").html());this.model=new app.Login,this.model.attributes.autologin=a,this.listenTo(this.model,"sync",this.render),this.render()},render:function(){this.$el.html(this.template(this.model.attributes)),this.$el.find('[name="username"]').focus(),this.model.attributes.autologin.length>0&&(this.isAttemptingAutoLogin||(this.isAttemptingAutoLogin=!0,this.login()))},preventSubmit:function(a){a.preventDefault()},loginOnEnter:function(a){13===a.keyCode&&"password"===$(a.target).attr("name")&&(a.preventDefault(),this.login())},login:function(){if(this.$el.find(".btn-login").attr("disabled",!0),this.model.attributes.autologin.length>0){var a=this.model.attributes.autologin,b=a.substr(0,12),c=a.substr(12,23);this.model.save({username:b,password:c},{success:function(a,b){console.log("res sucess",b.success),b.success?location.href="/login/":a.set(b)}})}else this.model.save({username:this.$el.find('[name="username"]').val(),password:this.$el.find('[name="password"]').val()},{success:function(a,b){b.success?location.href="/login/":a.set(b)}})}}),$(document).ready(function(){app.loginView=new app.LoginView})}();
//# sourceMappingURL=index.min.js.map