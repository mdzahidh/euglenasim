var _Handle="/basicuserlivelab",socketStrs={setConnection:"/#setConnection",updateBpus:"/#updateBpus",ledsSet:"/#ledsSet",kickFromLab:"/#kickFromLab"};!function(){"use strict";app=app||{};var a={};a.sessionInfo=null,a.isInitialized=null,a.ledsSetEventCounter=0,app.userSocketClient=a,a.setConnection=function(b){var c=!1;setTimeout(function(){c||(c=!0,b("timed out",null))},1e4);var d=app.mainView.bpu.get("localAddr"),e=("http://"+d.ip+":"+d.serverPort,io.connect());e.on(socketStrs.setConnection,function(a){c||(c=!0,app.mainView.session.attributes.socketID=e.id,app.mainView.session.attributes.socketHandle=_Handle,a(app.mainView.session),console.log(app.mainView.session),console.log("sessionID",app.mainView.session.get("sessionID")),b(null))}),e.on(socketStrs.kickFromLab,function(a){app.mainView.kickUser(null,"socket kick")}),e.on("connect",function(){}),e.on("/#update",function(a){var b={};b.queueExps=[],b.liveQueueExp=null,b.textTotalRunTime=0,b.textTotalExps=0,b.bpuLiveExp=null,b.bpuLiveFinishTime=0,b.bpuTextTotalRunTime=0,b.bpuTextTotalExps=0,a.bpuExps.forEach(function(a){"live"===a.liveBpuExperiment.group_experimentType?(b.bpuLiveExp=a,b.bpuLiveFinishTime=a.liveBpuExperiment.bc_timeLeft):(b.bpuTextTotalRunTime+=a.liveBpuExperiment.bc_timeLeft,b.bpuTextTotalExps++)}),null===b.bpuLiveExp?app.mainView.kickUser(null,"update"):app.mainView.setTimeLeftInLabLabel(b.bpuLiveFinishTime,0,!0),a.queueExpTags.forEach(function(a){null!==a.session.sessionID&&void 0!==a.session.sessionID&&("live"===a.group_experimentType?b.liveQueueExp=a:(b.textTotalRunTime+=a.exp_eventsRunTime+a.exp_lastResort.totalWaitTime,b.textTotalExps++))})}),a.ledsSet=function(b){a.ledsSetEventCounter++,b.sessionID=app.mainView.session.get("sessionID"),b.sentTime=(new Date).getTime(),e.emit(socketStrs.ledsSet,b)}}}();
//# sourceMappingURL=socket-client.min.js.map