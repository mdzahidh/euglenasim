var socketHandle="/livejoylab",socketStrs={setConnection:socketHandle+"/#setConnection",updateBpus:socketHandle+"/#updateBpus",ledsSet:socketHandle+"/#ledsSet",ping:socketHandle+"/#ping",kickFromLab:socketHandle+"/#kickFromLab"};!function(){"use strict";app=app||{};var a={};a.lastPing=new Date,a.lastBpuUpdate=null,a.mySocket=null,a.options=null,a.connectionInfo=null,app.userSocketClient=a,a.setConnection=function(b,c){a.options=b;var d=!1,e=setTimeout(function(){d||(d=!0,callback("timed out",null))},a.options.timeoutInterval);a.mySocket=io.connect(),a.mySocket.on("connect",function(){d||(d=!0,clearTimeout(e),a.connectionInfo={username:a.options.username,userID:a.options.userID,sessionID:a.options.sessionID,bpuID:a.options.bpuID,liveBpuExperimentID:a.options.liveBpuExperimentID,socketID:a.mySocket.id,socketHandle:socketHandle},a.mySocket.on(socketStrs.ping,function(a){a&&"function"==typeof a&&a()}),a.mySocket.emit(socketStrs.setConnection,a.connectionInfo,function(b,d){app.mainView.roughLabStartDate=new Date,b?c(b,null):(null===d.setLedsObj||void 0===d.setLedsObj?d.setLedsObj={time:null,topValue:null,rightValue:null,bottomValue:null,leftValue:null,metaData:{username:a.connectionInfo.username,userID:a.connectionInfo.userID,expID:a.connectionInfo.liveBpuExperimentID,bpuID:a.connectionInfo.bpuID,sessionID:a.connectionInfo.sessionID}}:(d.setLedsObj.metaData.username=a.connectionInfo.username,d.setLedsObj.metaData.userID=a.connectionInfo.userID,d.setLedsObj.metaData.expID=a.connectionInfo.liveBpuExperimentID,d.setLedsObj.metaData.bpuID=a.connectionInfo.bpuID,d.setLedsObj.metaData.sessionID=a.connectionInfo.sessionID),c(null,d.setLedsObj)),a.mySocket.on(socketStrs.kickFromLab,function(a){app.mainView.kickUser()})}))})},a.startUpdateBpus=function(){a.mySocket.on(socketStrs.updateBpus,function(b){a.lastBpuUpdate=new Date,b.bpusPackage&&b.bpusPackage.forEach&&b.bpusPackage.length>0&&b.bpusPackage.forEach(function(a){if(a.username===app.mainView.user.get("username")&&"live"===a.type){var b=a.expTimeLeft;Math.round(a.expTimeLeft/1e3);app.mainView.setTimeLeftInLabLabel(b,0,!0),app.mainView.wasTimeSetFromUpdate=!0}})})},a.ledsSet=function(b){b.sentTime=(new Date).getTime(),a.mySocket.emit(socketStrs.ledsSet,b,function(a,b){})}}();
//# sourceMappingURL=socket-client.min.js.map