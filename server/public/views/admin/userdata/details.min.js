!function(){"use strict";app=app||{},app.User=Backbone.Model.extend({idAttribute:"_id",url:function(){return"/admin/userdata/"+this.id+"/"}}),app.ActiveExperiment=Backbone.Model.extend({idAttribute:"_id",url:function(){return"/admin/userdata/"+this.id+"/"}}),app.UserInfo=Backbone.Model.extend({idAttribute:"_id",defaults:{success:!1,errors:[],errfor:{},isActive:"",username:"",email:""},url:function(){return"/admin/userdata/"+app.mainView.model.id+"/"},parse:function(a){return a.user&&(app.mainView.model.set(a.user),delete a.user),a}}),app.Experiment=Backbone.Model.extend({idAttribute:"_id",defaults:{success:!1,errors:[],errfor:{},isActive:"",username:"",email:""},url:function(){return"/admin/userdata/"+app.mainView.model.id+"/"},parse:function(a){return a.user&&(app.mainView.model.set(a.user),delete a.user),a}}),app.HeaderView=Backbone.View.extend({el:"#header",template:_.template($("#tmpl-header").html()),initialize:function(){this.model=app.mainView.model,this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.html(this.template(this.model.attributes))}}),app.UserInfoView=Backbone.View.extend({el:"#userinfo",template:_.template($("#tmpl-userinfo").html()),events:{},initialize:function(){console.log("UserInfoView initialize"),this.model=new app.UserInfo,this.syncUp(),this.listenTo(app.mainView.model,"change",this.syncUp),this.listenTo(this.model,"sync",this.render),this.render()},syncUp:function(){console.log("UserInfoView syncUp"),this.model.set({_id:app.mainView.model.id,username:app.mainView.model.get("username"),groupId:app.mainView.model.get("group").id,groupName:app.mainView.model.get("group").name,experiments:app.mainView.model.get("experiments")})},render:function(){console.log("UserInfoView render"),this.$el.html(this.template(this.model.attributes));for(var a in this.model.attributes)if(this.model.attributes.hasOwnProperty(a))if("experiments"===a){var b=this.$el.find('[name="'+a+'"]')[0],c=this.model.attributes[a];this.refreshDropdown(b,c),b.value=c[0],b.onchange=function(a){var b=a.target.value+"",c=null;app.mainView.experiments.forEach(function(a){a._id===b&&(c=a)}),null!==c&&(app.experimentView.model.set(c),app.experimentView.render())}}else this.$el.find('[name="'+a+'"]').val(this.model.attributes[a])},refreshDropdown:function(a,b){for(var c=a.options.length,d=0;c>d;d++)a.remove(a.options[0]);for(var d=0;d<b.length;d++){var e=document.createElement("OPTION");a.options.add(e),e.name=b[d],e.innerHTML=e.name,e.value=e.name}}}),app.ExperimentView=Backbone.View.extend({el:"#experiment",template:_.template($("#tmpl-experiment").html()),events:{},initialize:function(){console.log("ExperimentView initialize"),this.model=app.mainView.activeExperiment,this.syncUp(),this.listenTo(app.mainView.activeExperiment,"change",this.syncUp),this.listenTo(this.model,"sync",this.render),this.render()},syncUp:function(){console.log("ExperimentView syncUp");var a=app.mainView.activeExperiment;this.model.set({_id:a.attributes._id,endRunDate:a.attributes.endRunDate,bpuName:a.attributes.bpuName,pop1:a.attributes.pop1,dataFileName:a.attributes.dataFileName,dataPath:a.attributes.dataPath,msg:a.attributes.msg,id_bp:a.attributes.bpuData.id,username_bp:a.attributes.bpuData.username,isLive_bp:a.attributes.bpuData.isLive,isAuto_bp:a.attributes.bpuData.isAuto,autoType_bp:a.attributes.bpuData.autoType,useBpu_bp:a.attributes.bpuData.useBpu,runTime_bp:a.attributes.bpuData.runTime,data_bp:a.attributes.bpuData.data,runTime_bp:a.attributes.bpuData.runTime,startTime_bp:a.attributes.bpuData.startTime,eventsToRun_bp:a.attributes.bpuData.eventsToRun,eventsRan_bp:a.attributes.bpuData.eventsRan})},render:function(){console.log("ExperimentView render"),this.$el.html(this.template(this.model.attributes));for(var a in this.model.attributes)if(this.model.attributes.hasOwnProperty(a))if("eventsToRun_bp"===a||"eventsRan_bp"===a){var b=this.$el.find('[name="'+a+'"]')[0],c=this.model.attributes[a];void 0!==c&&0!==c.length||(c=["no data"]),this.refreshDropdown(b,c),b.value=c[0],b.onchange=function(a){}}else{var c=this.model.attributes[a];void 0!==c&&null!==c||(c="no data"),this.$el.find('[name="'+a+'"]').val(c)}},refreshDropdown:function(a,b){for(var c=a.options.length,d=0;c>d;d++)a.remove(a.options[0]);for(var d=0;d<b.length;d++){var e=document.createElement("OPTION");a.options.add(e),e.name=b[d],e.innerHTML=e.name,e.value=e.name}}}),app.MainView=Backbone.View.extend({el:".page .container",initialize:function(){app.mainView=this,this.model=new app.User(JSON.parse(unescape($("#data-record").html()))),this.experiments=JSON.parse(unescape($("#data-experiments").html())),this.activeExperiment=new app.Experiment(this.experiments[0]),app.headerView=new app.HeaderView,app.userInfoView=new app.UserInfoView,app.experimentView=new app.ExperimentView}}),$(document).ready(function(){app.mainView=new app.MainView})}();
//# sourceMappingURL=details.min.js.map